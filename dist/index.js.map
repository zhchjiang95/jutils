{"version":3,"file":"index.js","sources":["../src/adaptiveScaling.ts","../src/boxAnchor.ts","../src/formatDate.ts","../src/infiniteScroll.ts","../src/pageAnchor.ts","../src/slideDirection.ts"],"sourcesContent":["/**\n * 自适应等比缩放。适用大屏可视化自动适配屏幕\n * @param targetEl 需要去适应的（父级）盒子, 将元素等比例缩放撑满盒子（进入全屏状态的元素应该是父级盒子）。\n * @param sourceEl 需要被缩放的元素，它会自适应父级盒子。\n * @param designSize 设计稿尺寸，如：1920x1080，则传入[1920,1080]。\n * @example\n * ```js\n * adaptiveScaling(HTMLElement, HTMLElement, [1920, 1080])\n * ```\n */\nconst adaptiveScaling = (\n  targetEl: HTMLElement,\n  sourceEl: HTMLElement,\n  designSize: number[]\n) => {\n  const [designW, designH] = designSize;\n  const targetWidth = targetEl.clientWidth;\n  // const targetHeight = targetEl.clientHeight;\n  // 盒子尺寸比\n  // const realRatio = targetWidth / targetHeight;\n  // 设计稿比例\n  // const designRatio = designW / designH;\n  // 缩放率\n  let scaleRate = targetWidth / designW;\n  // 如果是竖屏，按高缩放\n  // if (realRatio.toFixed(1) > designRatio.toFixed(1)) {\n  //   scaleRate = targetHeight / designH;\n  // }\n  sourceEl.style.transformOrigin = \"left top\";\n  sourceEl.style.transform = `scale(${scaleRate})`;\n  // sourceEl.style.width = `${targetWidth / scaleRate}px`;\n};\n\nexport default adaptiveScaling;\n","/**\n * 盒子锚点，在任意可滑动盒子中跳转；监听事件元素需指定 data-jt-id 值为目标元素唯一标识 id\n * @param options\n * 1、source：监听点击事件元素（或其父级）选择器，请确保唯一(①选择器带元素名（如：button#search）则监听其内部最深层的元素（理论情况，既实际点击到的元素），该元素须添加 data-jt-id 属性，属性值为目标容器内目标对象的 id（该目标对象须指定 data-jt-type 的值为 'jt'，以配合 callback 工作）。②选择器不带元素名（如：#search）则只监听此元素点击事件，data-jt-id 属性须绑定在此元素上。)；\n * 2、target：目标可滚动容器的选择器，请确保唯一，容器内的目标对象 id 值为对应的 data-jt-id 值（该目标对象须指定 data-jt-type 的值为 'jt'，以配合 callback 工作）；\n * 3、diff：滑动到与父元素的顶部距离差，默认值：4；\n * 4、speed：滑动速度，默认值：20。\n * @param callback 指定回调函数后，函数将在滚动过程定点执行，函数参数默认返回一个对象，包含此时在可视屏幕内指定 data-jt-id 属性的元素和该元素的 data-jt-id 属性值（须目标容器中目标对象指定 data-jt-type 的值为 'jt'）。\n * @example\n * ```js\n * <div id=\"source-box\"><a data-jt-id=\"h1\">锚点到h1</a></div>\n * <div id=\"target-box\"><h4 id=\"h1\" data-jt-type=\"jt\">我的id是h1</h4></div>\n * boxAnchor({source: 'div#source-box', target: '#target-box'}, (res) => {})\n * ```\n */\nconst boxAnchor = (\n  options: { source: string; target: string; diff?: number; speed?: number },\n  callback: (res: { el: HTMLElement; jtId: string }) => void\n) => {\n  var source = document.querySelector(options.source) as HTMLElement,\n    box = document.querySelector(options.target) as HTMLElement,\n    boxChildren = Array.from(box?.children || []).filter(\n      (v: any) => v.dataset.jtType === \"jt\"\n    ),\n    V: HTMLElement,\n    arr: Element[] | null = null;\n  source.onclick = function (e) {\n    var id =\n      \"#\" +\n      (/^[.|#]/.test(options.source)\n        ? (this as HTMLElement).dataset.jtId\n        : (e.target as HTMLElement).dataset.jtId);\n    var target = document.querySelector(id) as HTMLElement;\n    if (!target) return;\n    var diff = options.diff ? options.diff : 0;\n    var speed = options.speed ? options.speed : 10;\n    var targetHeight = parseFloat(getComputedStyle(target).height);\n    var flag = box.scrollTop >= target.offsetTop - targetHeight - diff;\n    (function jMove() {\n      if (flag) {\n        if (\n          box.scrollTop > target.offsetTop - targetHeight - diff &&\n          box.scrollTop !== 0\n        ) {\n          box.scrollTo(0, box.scrollTop - speed);\n          requestAnimationFrame(jMove);\n        }\n      } else {\n        if (\n          target.offsetTop - targetHeight - diff - box.scrollTop > speed &&\n          box.scrollTop + box.offsetHeight < box.scrollHeight - speed\n        ) {\n          box.scrollTo(0, box.scrollTop + speed);\n          requestAnimationFrame(jMove);\n        }\n      }\n    })();\n    return false;\n  };\n  typeof callback === \"function\" &&\n    box.addEventListener(\"scroll\", function () {\n      boxChildren.map((v: any) => {\n        if (v !== V) {\n          V = v;\n          v.distance = Math.abs(v.offsetTop - box.scrollTop);\n        }\n      });\n      const tmp = boxChildren.sort((p: any, n: any) => p.distance - n.distance);\n      if (!arr || arr[0].id !== tmp[0].id) {\n        arr = tmp.slice();\n        callback({\n          el: tmp[0] as HTMLElement,\n          jtId: tmp[0].id,\n        });\n      }\n    });\n};\n\nexport default boxAnchor;\n","/**\n * 格式化当前或自定义时间日期，自定义年月日分隔符和时分秒显示\n * @param opts sep: 年月日分隔符; millisecond: 自定义时间（毫秒）或Date(); showHours: 是否显示时分秒。默认：false\n * @returns string\n * @example\n * ```js\n * formatTime({sep: '-', millisecond: Date.now() + 20, showHours: true}) // 2020-08-24 15:06:32\n * ```\n */\nconst formatDate = (opts?: {\n  sep?: string;\n  millisecond?: string | number;\n  showHours?: boolean;\n}) => {\n  const separator = opts?.sep || \"-\";\n  const hasHours = opts?.showHours || false;\n  let dateTimer = opts?.millisecond\n    ? new Date(Number(opts.millisecond))\n    : new Date();\n  let Y: number | string = dateTimer.getFullYear();\n  let M: number | string = dateTimer.getMonth() + 1;\n  let D: number | string = dateTimer.getDate();\n  let h: number | string = dateTimer.getHours();\n  let m: number | string = dateTimer.getMinutes();\n  let s: number | string = dateTimer.getSeconds();\n  M = M >= 10 ? M : \"0\" + M;\n  D = D >= 10 ? D : \"0\" + D;\n  h = h >= 10 ? h : \"0\" + h;\n  m = m >= 10 ? m : \"0\" + m;\n  s = s >= 10 ? s : \"0\" + s;\n\n  return hasHours\n    ? `${Y + separator + M + separator + D} ${h}:${m}:${s}`\n    : `${Y + separator + M + separator + D}`;\n};\n\nexport default formatDate;\n","/**\n * 滚动至底部时，加载更多数据，或执行一些自定义的事件。返回函数清除绑定\n * @param opts ①el：需要无限滚动元素的选择器，请确保唯一；②delay：节流时延，单位为ms，默认值100；③distance：触发加载的距离阈值，单位为px，默认值10。\n * @param callback 到达距离阈值时触发的事件\n * @returns unbind 返回一个可清除绑定滚动事件的函数。\n * @example\n * ```js\n * infiniteScroll({el: '.big-box', delay: 100, distance: 10 }, () => { console.log('hello') }))\n * ```\n */\nconst infiniteScroll = (\n  opts: { el: string; delay?: number; distance?: number },\n  callback: () => void\n) => {\n  var box = document.querySelector(opts.el) as HTMLElement;\n  var delay = opts.delay || 100,\n    distance = opts.distance || 10,\n    timer: NodeJS.Timeout,\n    flag = true;\n  var unbind = () => {\n    box.onscroll = null;\n  };\n  box.onscroll = function () {\n    if (flag) {\n      var boxHeight = parseFloat(getComputedStyle(box).height),\n        boxScrollHeight = box.scrollHeight,\n        boxScrollTop = box.scrollTop;\n      flag = false;\n      timer = setTimeout(function () {\n        flag = true;\n      }, delay);\n      if (boxScrollHeight - boxScrollTop - boxHeight < distance) {\n        callback();\n      }\n    }\n  };\n  return unbind;\n};\n\nexport default infiniteScroll;\n","/**\n * 指定页面滑动到某个位置，自定义滑动速度/滑动方向。须整个页面可滑动\n * @param opts anchor：滑动到的目标位置；speed：滑动速度；down：向下滑动？向下（true）/向上（false），默认：true\n * @example\n * ```js\n * pageAnchor(100, 10, true)\n * ```\n */\nconst pageAnchor = (opts?: {\n  anchor?: number;\n  speed?: number;\n  down?: boolean;\n}) => {\n  var anchor = opts?.anchor || 0,\n    speed = opts?.speed || 10,\n    down = opts?.down === undefined ? true : Boolean(opts.down);\n  (function foo() {\n    if (down) {\n      if (scrollY < anchor) {\n        var scrollTop =\n            document.documentElement.scrollTop || document.body.scrollTop,\n          clientHeight =\n            document.documentElement.clientHeight || document.body.clientHeight,\n          scrollHeight =\n            document.documentElement.scrollHeight || document.body.scrollHeight;\n        if (\n          scrollHeight > clientHeight &&\n          scrollTop + clientHeight < scrollHeight\n        ) {\n          scrollTo(0, scrollY + speed);\n          requestAnimationFrame(foo);\n        }\n      }\n    } else {\n      if (scrollY > anchor) {\n        scrollTo(0, scrollY - speed);\n        requestAnimationFrame(foo);\n      }\n    }\n  })();\n};\n\nexport default pageAnchor;\n","interface CallBack {\n  (\n    dir: {\n      startX?: number;\n      startY?: number;\n      endX?: number;\n      endY?: number;\n    },\n    real: {\n      realX?: number;\n      realY?: number;\n    }\n  ): void;\n}\n/**\n * 判断在屏幕上滑动的方向，允许在任意盒子中滑动，移动过程中实时返回当前X/Y坐标，接收回调函数，返回起始位置和结束位置的X/Y坐标值对象，支持 PC 和移动端。\n * @param selector 指定在某个元素上滑动，传入其标签名或 class 或 id，请确保使用唯一标识\n * @param cb 回调函数，第一个参数为滑动结束时包含起始位置和结束位置的X/Y坐标值对象\n * @param realXY 滑动/移动过程是否实时返回当前X/Y坐标，开启后回调函数中支持第二个参数接收实时坐标对象，默认：false\n * @param realStartEndXY 实时返回当前X/Y坐标后，同时是否实时返回起始位置和结束位置的X/Y坐标值对象，默认：false，返回空对象\n * @example\n * ```js\n * slideDirection('#box', (dir, real) => console.log(dir), true, false) // {startX: 54, startY: 82, endX: 54, endY: 82}\n * ```\n */\nconst slideDirection = (\n  selector: string | HTMLDivElement,\n  cb: CallBack,\n  realXY = false,\n  realStartEndXY = false\n) => {\n  let startX = 0,\n    startY = 0,\n    endX = 0,\n    endY = 0,\n    realX = 0,\n    realY = 0,\n    el =\n      typeof selector === \"string\"\n        ? (document.querySelector(`${selector}`) as HTMLElement)\n        : selector;\n  if (el === null) {\n    throw new Error(`${selector}无法查找到元素`);\n  }\n  if (el.ontouchstart === null) {\n    el.ontouchstart = function (e) {\n      endX = endY = realX = realY = 0;\n      startX = e.changedTouches[0].clientX;\n      startY = e.changedTouches[0].clientY;\n    };\n    realXY &&\n      (el.ontouchmove = function (e) {\n        realX = e.changedTouches[0].clientX;\n        realY = e.changedTouches[0].clientY;\n        cb(\n          realStartEndXY\n            ? {\n                startX,\n                startY,\n                endX,\n                endY,\n              }\n            : {},\n          {\n            realX,\n            realY,\n          }\n        );\n      });\n    el.ontouchend = function (e) {\n      endX = e.changedTouches[0].clientX;\n      endY = e.changedTouches[0].clientY;\n      cb(\n        {\n          startX,\n          startY,\n          endX,\n          endY,\n        },\n        {\n          realX,\n          realY,\n        }\n      );\n    };\n  } else {\n    el.onmousedown = function (e) {\n      endX = endY = realX = realY = 0;\n      startX = e.clientX;\n      startY = e.clientY;\n      realXY &&\n        (el.onmousemove = function (e) {\n          realX = e.clientX;\n          realY = e.clientY;\n          cb(\n            realStartEndXY\n              ? {\n                  startX,\n                  startY,\n                  endX,\n                  endY,\n                }\n              : {},\n            {\n              realX,\n              realY,\n            }\n          );\n        });\n    };\n    document.onmouseup = function (e) {\n      if (el.onmousemove === null) return;\n      endX = e.clientX;\n      endY = e.clientY;\n      el.onmousemove = null;\n      cb(\n        {\n          startX,\n          startY,\n          endX,\n          endY,\n        },\n        {\n          realX,\n          realY,\n        }\n      );\n    };\n  }\n};\n\nexport default slideDirection;"],"names":["targetEl","sourceEl","designSize","designW","scaleRate","clientWidth","style","transformOrigin","transform","concat","options","callback","V","source","document","querySelector","box","target","boxChildren","Array","from","children","filter","v","dataset","jtType","arr","onclick","e","id","test","this","jtId","diff","speed","targetHeight","parseFloat","getComputedStyle","height","flag","scrollTop","offsetTop","jMove","scrollTo","requestAnimationFrame","offsetHeight","scrollHeight","addEventListener","map","distance","Math","abs","tmp","sort","p","n","slice","el","opts","separator","sep","hasHours","showHours","dateTimer","millisecond","Date","Number","Y","getFullYear","M","getMonth","D","getDate","h","getHours","m","getMinutes","s","getSeconds","delay","onscroll","boxHeight","boxScrollHeight","boxScrollTop","setTimeout","anchor","down","undefined","Boolean","foo","scrollY","documentElement","body","clientHeight","selector","cb","realXY","realStartEndXY","startX","startY","endX","endY","realX","realY","Error","ontouchstart","changedTouches","clientX","clientY","ontouchmove","ontouchend","onmousedown","onmousemove","onmouseup"],"mappings":"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"}